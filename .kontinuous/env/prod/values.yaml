global:
  s3SecretName: vao-prod-app-access-key

backend:
  resources:
    requests:
      cpu: 200m
      memory: 512Mi
    limits: # exports need a lot of CPU/RAM ATM
      cpu: 500m
      memory: 768Mi
  host: api-vao.social.gouv.fr
  redirectFrom:
    - "api-{{ .Values.global.host }}"
  vars:
    S3_BUCKET_ROOT_DIR: prod/files


frontend-usagers:
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits: # exports need a lot of CPU/RAM ATM
      cpu: 200m
      memory: 256Mi
  host: vao.social.gouv.fr
  redirectFrom:
    - "{{ .Values.global.host }}"

frontend-bo:
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits: # exports need a lot of CPU/RAM ATM
      cpu: 200m
      memory: 256Mi
  host: admin-vao.social.gouv.fr
  redirectFrom:
    - "bo-{{ .Values.global.host }}"

pg:
  cnpg-cluster:
    resources:
      requests:
        memory: 1Gi
      limits:
        cpu: "1"
        memory: 1Gi

jobs:
  runs:
    build-frontend-usagers:
      with:
        buildArgs:
          NUXT_PUBLIC_APP_VERSION: "{{ .Values.global.gitBranch }}"
          NUXT_PUBLIC_BACKEND_URL: "https://api-vao.social.gouv.fr"
          NUXT_PUBLIC_ENVIRONMENT: "production"
          NUXT_PUBLIC_SENTRY_ENABLED: "true"
    build-frontend-bo:
      with:
        buildArgs:
          NUXT_PUBLIC_APP_VERSION: "{{ .Values.global.gitBranch }}"
          NUXT_PUBLIC_BACKEND_URL: "https://api-vao.social.gouv.fr"
          NUXT_PUBLIC_ENVIRONMENT: "production"
          NUXT_PUBLIC_SENTRY_ENABLED: "true"
