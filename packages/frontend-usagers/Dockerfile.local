FROM local-node:latest as builder

USER root

WORKDIR /usr/cache

COPY package*.json yarn.lock ./
COPY packages/shared packages/shared/
COPY packages/frontend-usagers/package*.json packages/frontend-usagers/yarn.lock packages/frontend-usagers/

RUN chown -R node /usr/cache

USER node

RUN yarn workspace @vao/frontend-usagers install

WORKDIR /app

CMD ["yarn" "workspace", "@vao/frontend-usagers", "dev"]